<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>cds: cds::memory::michael::opt::check_bounds&lt; TYPE &gt; Struct Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="namespacecds.html">cds</a>      </li>
      <li><a class="el" href="namespacecds_1_1memory.html">memory</a>      </li>
      <li><a class="el" href="namespacecds_1_1memory_1_1michael.html">michael</a>      </li>
      <li><a class="el" href="namespacecds_1_1memory_1_1michael_1_1opt.html">opt</a>      </li>
      <li><a class="el" href="structcds_1_1memory_1_1michael_1_1opt_1_1check__bounds.html">check_bounds</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>cds::memory::michael::opt::check_bounds&lt; TYPE &gt; Struct Template Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="cds::memory::michael::opt::check_bounds" -->
<p>Option setter for bounds checking.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;cds/memory/michael/options.h&gt;</code></p>
<table class="memberdecls">
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<h3>template&lt;typename TYPE&gt;<br/>
 struct cds::memory::michael::opt::check_bounds&lt; TYPE &gt;</h3>

<p>Option setter for bounds checking. </p>
<p>This option defines a strategy to check upper memory boundary of allocated blocks. <code>TYPE</code> defines a class for bound checking with following interface:</p>
<div class="fragment"><pre class="fragment">            <span class="keyword">class </span>bound_checker 
            {
            <span class="keyword">public</span>:
                <span class="keyword">enum</span> {
                    trailer_size = numeric_const
                };

                <span class="keywordtype">void</span> make_trailer( <span class="keywordtype">void</span> * pStartArea, <span class="keywordtype">void</span> * pEndBlock, <span class="keywordtype">size_t</span> nAllocSize ) ;
                <span class="keywordtype">bool</span> check_bounds( <span class="keywordtype">void</span> * pStartArea, <span class="keywordtype">void</span> * pEndBlock, <span class="keywordtype">size_t</span> nBlockSize ) ;
            }
</pre></div><p>Before allocating a memory block of size N, the heap adds the <code>trailer_size</code> to N and really it allocates N + trailer_size bytes. Then, the heap calls <code>make_trailer</code> function of bound checker with arguments:</p>
<ul>
<li><code>pStartArea</code> - start of allocated block</li>
<li><code>pEndBlock</code> - the first byte after really allocated block; <div class="fragment"><pre class="fragment"> pEndBlock - pStartArea &gt;= N + trailer_size 
</pre></div></li>
<li><code>nAllocSize</code> - requested size in bytes (i.e. N) So, <code>make_trailer</code> function can place some predefined value called bound mark of any type, for example, int64, on address pStartArea + nAllocSize, and store real allocated block size N to pEndBlock - sizeof(size_t). In this example, <code>trailer_size</code> constant is equal sizeof(int64) + sizeof(size_t).</li>
</ul>
<p>Before the memory block previously allocated is deallocating, the <code><a class="el" href="structcds_1_1memory_1_1michael_1_1opt_1_1check__bounds.html" title="Option setter for bounds checking.">check_bounds</a></code> function is called. The function has similar signature:</p>
<ul>
<li><code>pStartArea</code> - start of allocated block (like <code>make_trailer</code> fist argument)</li>
<li><code>pEndBlock</code> - the first byte after allocated block (like <code>make_trailer</code> second argument)</li>
<li><code>nBlockSize</code> - real allocated block size, not equal to <code>nAllocSize</code> argument of <code>make_trailer</code> </li>
</ul>
<p>The function can:</p>
<ul>
<li>calculate real allocated block size: <div class="fragment"><pre class="fragment"> N = *<span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(pEndBlock - <span class="keyword">sizeof</span>(size_t)) 
</pre></div></li>
<li>check whether the bound mark is unchanged: <div class="fragment"><pre class="fragment"> *<span class="keyword">reinterpret_cast&lt;</span>int64<span class="keyword">&gt;</span>(pStartArea + N) == bound_mark 
</pre></div></li>
<li>if it is not equal - make assertion</li>
</ul>
<p>The library provides the following predefined bound checkers, i.e they are possible values of <code>TYPE</code> template argument: </p>
<ul>
<li><a class="el" href="structcds_1_1opt_1_1none.html" title="Type indicates that no option is being used and that the default options should be used...">cds::opt::none</a> - no bound checking is performed (default) </li>
<li><a class="el" href="classcds_1_1memory_1_1michael_1_1debug__bound__checking.html" title="Debug bound checker.">michael::debug_bound_checking</a> - an assertion is thrown when memory bound violation is detected. This option is acceptable only in debug mode. For release mode it is equal to <a class="el" href="structcds_1_1opt_1_1none.html" title="Type indicates that no option is being used and that the default options should be used...">cds::opt::none</a>. </li>
<li><a class="el" href="classcds_1_1memory_1_1michael_1_1strong__bound__checking.html" title="Exception throwing bound checker">michael::strong_bound_checking</a> - an assertion is thrown in debug mode if memory bound violation is detected; an exception is thrown in release mode. </li>
</ul>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>cds/memory/michael/options.h</li>
</ul>
</div>
		<hr/>
		<div align="right">
			<b>cds</b> <b>0.8.0</b> 
			Developed by <i>Maxim Khiszinsky aka khizmax</i> 2007 - 2011
			<br/>
			<i>Autogenerated Mon Mar 28 2011 21:10:40 by Doxygen 1.7.2</i>
		</div>
	</BODY>
</HTML>
